<?xml version="1.0" encoding="UTF-8"?>
<article id="registry_menu">
  <title>The <guimenu>Registry</guimenu> Menu</title>

  <para>The <guimenu>Registry</guimenu> menu contains items related to methods of launching Frhed,
  the registry data, relations with previous versions of Frhed and different
  instances of Frhed.</para>

  <para>Of course if you are a power user you will probably prefer to do all of the below yourself.</para>

  <para>I (Pabs) am thinking of merging all/most of this into an &quot;Frhed manager&quot; - email me if you think it is a good idea.</para>

  <section>
    <title>In all context menu</title>
    
    <para>When checked this item indicates that in the context menu of all files
    there appears an item named &quot;<guimenuitem>Open in Frhed</guimenuitem>&quot; which will launch
    Frhed with the file opened.</para>
  </section>

  <section>
    <title>In unknown context menu</title>
    
    <para>The same is true of this item except that the item appears only in the
    context menu of files that have an extension that has not yet been registered
    with Windows.  NOTE that if both are checked both will appear on the menu
    of unregistered files and that these files generally have an
    &quot;<guimenuitem>Open with&hellip;</guimenuitem>&quot; command.</para>
  </section>

  <section>
    <title>Is default in unknown context</title>
    
    <para>When this item is checked the &quot;Open in Frhed&quot; command for
    unregistered files becomes the default action when double clicking or
    pressing enter on these files in explorer.  This may not work properly
    but it should.  The reason a similar option was not provided for the all
    context is that then you would not be able to open your files with the
    proper applications.  It is not recommended but if you wish you may do
    this yourself - just set the default value in the key &quot;HKEY_CLASSES_ROOT\*\shell&quot;
    to &quot;<guimenuitem>Open in Frhed</guimenuitem>&quot;.  This is disabled if the above option is
    not checked.  Unchecking the above option unchecks and disables this one.</para>
  </section>

  <section>
    <title>Save ini when required</title>
    
    <para>When this item is unchecked Frhed will not save data to the registry
    when it normally does.  It does this on exit and at other times -
    see the source where the function save_ini_data is called.  This option
    was added so that the <menuchoice><guimenu>Registry</guimenu>
    <guimenuitem>Remove Frhed</guimenuitem></menuchoice> item could work properly.</para>
  </section>

  <section>
    <title>Change instance</title>
    
    <para>Allows the user to switch from one set of instance options to another
    and to specify the instance number to save to on exit and at other times.
    Note that if 2 or more instances of Frhed are open at once the options you
    save on exit may be overwritten.  If you enter a non-existent instance
    number that instance will be written to the registry with current values
    and current values will stay the same.  This option is always enabled so
    that you may reload instance options at any time.</para>
  </section>

  <section>
    <title>Remove Frhed</title>
    
    <para>Removes, in this order, registered links to Frhed, both context menu
    entries, registry entries for the current version and registry entries
    for old versions.  This option requires an initial confirmation and
    confirmations for each removal operation that is required.  If the user
    removes those of the links, context menu entries and or registry entries
    for the current version that are present they are given instructions on
    how to totally remove Frhed from their computer and asked to email the
    author. This option is disabled if none of the above are present. Previous
    versions of Frhed are ignored.</para>
  </section>

  <section>
    <title>Upgrade</title>
    
    <para>This brings up a dialog box that can be used to upgrade Frhed.</para>
    
    <para>To help you decide which version to upgrade from you can browse the
    versions &amp; instances, using the data list, MRU list, link list and the
    'fake' Frhed display window to find the instance you are looking for
    and show you various properties of the selected instance.</para>
    
    <para>This dialog allows the following:</para>
    
    <itemizedlist>
      <listitem>
        <para>Copying instances from a version to the current version.</para>
      </listitem>
      <listitem>
        <para>Reading the data from a selected instance into memory.</para>
      </listitem>
      <listitem>
        <para>For reading and copying, links from the selected version are copied over and rewritten to the disk, updating them in the process.</para>
      </listitem>
      <listitem>
        <para>Deleting selected instances from selected versions.</para>
      </listitem>
    </itemizedlist>
    
    <para>If you work only with the registry, however, you have much more
    control over your options and by exporting the HKCU\Software\Frhed key
    to a &quot;.reg&quot; file, deleting the key, editing the file and
    importing it back into the registry you can combine options from several
    previous versions.  It is recommended that you use the upgrade dialog or
    the shortcut manager (next section) to (automatically) update links after
    you have manually edited the registry.</para>
    
    <para>Note that versions of Frhed before v1.0.154 used ini files and therefore
    you cannot upgrade from them without manually entering their data into the
    registry or converting the ini files to reg files.</para>
  </section>

  <section>
    <title>Shortcuts to Frhed</title>
    
    <para>This is a link manager specific to Frhed.  All links to Frhed created
    by this have the filename &quot;frhed.lnk&quot;. You can add new links
    by specifying paths to put them in, move existing links to new paths, delete
    links one at a time, reload the list of links from the registry, find links
    to current &amp; old versions in the file system and create links in any of
    four predefined places:</para>
    
    <orderedlist>
      <listitem>
        <simpara>The Desktop</simpara>
      </listitem>
      <listitem>
        <simpara>Start menu</simpara>
      </listitem>
      <listitem>
        <simpara>Programs menu</simpara>
      </listitem>
      <listitem>
        <simpara>Send To menu</simpara>
      </listitem>
    </orderedlist>
    
    <para>The paths of these are read from the registry and should always point to the correct path.
    The paths of the links (without names) are stored in the registry under HKCU\Software\Frhed\<replaceable>&lt;current version&gt;</replaceable>\links.
    All values in this key that contain strings are loaded into the list of links after being verified and or updated.</para>
    
    <para>Note that:</para>
    <itemizedlist>
      <listitem>
        <para>The link manager tries to keep the registry &amp; file system up to date as much as possible and if you delete a link from explorer &amp; load the link manager the all items in the registry will be recreated.</para>
      </listitem>
      <listitem>
        <para>Duplicates are not allowed and if you delete one of the values from the registry then Frhed will not be able to delete the corresponding link from the file system.</para>
      </listitem>
      <listitem>
        <para>You cannot create links on read-only devices as the browsing mechanism detects volumes where files cannot be created. These include places that do not have a path in the file system, like places such as Control Panel etc., places on read-only media and places on volumes that are full.</para>
      </listitem>
      <listitem>
        <para>Renaming a link will allow you to delete it from the registry but not the file system.</para>
      </listitem>
      <listitem>
        <para>If there are links to removable media you may see DVD/CD/floppy activity when Frhed is searching for links.</para>
      </listitem>
      <listitem>
        <para>Note that to have links to more than one version of Frhed (that has the shortcut manager) you will have to create one link, rename it by appending a version no and then create the other link and rename it in the same way. This will ensure that if you accidentally add a link to Frhed to a folder then links to any old versions will not be overwritten. These links will not be safe from the find n&apos; fix function - to make them safe rename the exe by appending a version number and create a link to the exe that is not named Frhed.lnk (to prevent it being overwritten).</para>
      </listitem>
      <listitem>
        <para>Update &amp; find n&apos; fix both search recursively from a user specified directory for links to Frhed - update looks for links to the filename of the running version of Frhed while find n&apos; fix looks for links to any frhed.exe that is in the search tree. Duplicate links in the same directory will be removed and all links found will be renamed to frhed.lnk.</para>
      </listitem>
    </itemizedlist>
  </section>
</article>